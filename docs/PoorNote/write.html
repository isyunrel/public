<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>添加笔记 - PoorNote</title>
    <link rel="stylesheet" href="./css/global.css">
    <link rel="stylesheet" href="./css/font-awesome.min.css">
    <link rel="stylesheet" href="./css/write.css">
</head>

<body>

    <div id="login__tip">
        您当前尚未登录，如果想进行更多操作，请<a href="./login.html">登录</a>
    </div>
    <header class="header">
        <div class="box-inner">
            <div class="header__logo">
                <a href="./index.html">PoorNote</a>
            </div>

            <div class="header__search">
                <input id="search__text" type="text" placeholder="搜索笔记">
                <i id="search__btn" class="fa fa-search"></i>
            </div>

            <a class="login__btn" href="./login.html">登录</a>
            
            <div id="user">
                <a href="./home.html">
                    <img id="user__head" src="./src/head.jpg" alt="userhead哈哈哈">
                </a>
                <div class="user__options">
                    <a href="home.html">个人主页</a>
                    <a id="logOut" href="javascript:">登出</a>
                </div>
            </div>

            <nav class="header__nav">
                <ul>
                    <li><a href="./index.html"><i class="fa fa-home"></i> 首页</a></li>
                    <li><a href="./write.html"><i class="fa fa-won"></i> 书写</a></li>
                    <li><a href="./about.html"><i class="fa fa-info"></i> 关于</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="write__container box-inner">
        <input class="note__title" maxlength = "50" type="text" placeholder="笔记标题">
        <p id="note__title__tip">0 / 40</p>

        <div id="editor"></div>

        <div class="flags">
            <p>添加标签(最多选择 3 个标签)</p>
            <span>游戏1</span>
            <span>游戏2</span>
            <span>游戏3</span>
            <span>游戏4</span>
            <span>游戏5</span>
            <span>游戏6</span>
        </div>
        <div class="option">
            <input id="isPublic" type="checkbox"> 公开笔记
            <button id="submit">发表</button>
        </div>
    </div>

    <script src="./js/jquery-3.4.1.min.js"></script>
    <script src="./js/jquerysession.js"></script>
    <script src="./js/wangEditor.min.js"></script>
    <script src="./js/global.js"></script>
    <script>
        let E = window.wangEditor
        let editor = new E('#editor')
        editor.customConfig.uploadImgShowBase64 = true;
        
        let aFlag = {},
            iFlagCount = 0;
        editor.create();

        let oSubmit = document.querySelector("#submit"),
            oIsPublic = document.querySelector("#isPublic");
        $('#submit').click(function() {
            let sHtml = editor.txt.html(),
                bIsPublic = $("#isPublic").get(0).checked,
                sTitle = $(".note__title").get(0).value,
                aFinalFlag = [];
            for(let idx in aFlag) {
                if(aFlag[idx]) {
                    aFinalFlag.push(idx);
                }
            }
            aFinalFlag.sort();
        })

        $(".note__title").get(0).oninput = function() {
            let iLength = $('.note__title').get(0).value.length;
            $('#note__title__tip').html(iLength + ' / 40');
            if(iLength > 50) {
                $('#note__title__tip').css("color", "red");
            } else {
                $('#note__title__tip').css("color", "#aaa");
            }
        };

        $(".flags").find("span").click(function() {
            let sFlagStr = $(this).text();
            if(aFlag[sFlagStr]) {
                aFlag[sFlagStr] = false;
                $(this).css("backgroundColor", "#ccc");
                iFlagCount--;
            } else if(iFlagCount < 3) {
                aFlag[sFlagStr] = true;
                $(this).css("backgroundColor", "#7f7bec");
                iFlagCount++;
            }
        })

    </script>
    
</body>
</html>